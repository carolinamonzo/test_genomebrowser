<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQANTI3 intergenic Isoforms</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedheader/3.4.0/css/fixedHeader.dataTables.min.css">
    
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 20px; 
            background-color: #f8f9fa;
        }
        h2 { color: #2c3e50; }
        .container { 
            background-color: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .info-box {
            background-color: #f1f3f5;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 5px solid #6c757d;
        }
        .info-box p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        table.dataTable thead th {
            background-color: #e9ecef;
            color: #495057;
            white-space: nowrap;
        }
        /* Table cells */
        table.dataTable tbody td {
            white-space: nowrap;
            font-size: 0.9em;
            padding: 4px 10px;
        }
        /* Filter input styling */
        tfoot input, thead select {
            width: 100%;
            padding: 3px;
            box-sizing: border-box;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 0.8em;
        }
        .dataTables_wrapper { margin-top: 20px; }
    </style>

    <!-- jQuery and DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/fixedheader/3.4.0/js/dataTables.fixedHeader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
    <div class="container">
        <h2>SQANTI3 Analysis: intergenic Isoforms</h2>
        
        <div class="info-box">
            <div style="text-align: center; margin-bottom: 15px; min-height: 80px;">
                <svg width="550" height="110" viewBox="0 0 400 80" xmlns="http://www.w3.org/2000/svg"><rect x="10" y="8" width="40" height="8" fill="black" rx="2"/><text x="220" y="15" font-family="sans-serif" font-size="12" fill="black" font-weight="bold">Reference</text><rect x="140" y="48" width="40" height="8" fill="#E9967A" rx="2"/><text x="220" y="55" font-family="sans-serif" font-size="12" fill="#E9967A" font-weight="bold">Isoform (Inter)</text></svg>
            </div>
            <p><strong>Category Definition:</strong> <b>Intergenic:</b> The query isoform is in the intergenic region.</p>
            <p>
                For more details on categories, visit here: <a href="https://github.com/ConesaLab/SQANTI3/wiki/SQANTI3-isoform-classification:-categories-and-subcategories" target="_blank">SQANTI3 Wiki: Categories</a>.
                <br>
                For a detailed explanation of each column of the table (SQANTI3 classification), see here: <a href="https://github.com/ConesaLab/SQANTI3/wiki/Understanding-the-output-of-SQANTI3-QC#classifcols" target="_blank">Column Glossary</a>.
            </p>
            <hr style="border-top: 1px solid #dee2e6; margin: 15px 0;">
            <p><strong>How to Filter:</strong></p>
            <ul style="margin-bottom: 5px; padding-left: 20px;">
                <li><strong>Numeric Columns (e.g., length, exons):</strong> Use ranges like <code>100:1000</code> (values between 100 and 1000), <code>100:</code> (>100), or <code>:1000</code> (<1000). Single numbers perform an exact match.</li>
                <li><strong>Dropdowns:</strong> Select a value to filter for an exact match.</li>
                <li><strong>Text Columns:</strong> Type to search for substrings (case-insensitive).</li>
            </ul>
        </div>

        <p>Total transcripts: 41 | <a href="javascript:window.close();">Close Window</a></p>
        
        <table id="isoformTable" class="display stripe hover row-border order-column" style="width:100%">
            <thead>
                <tr>
                    <th>isoform</th><th>chrom</th><th>strand</th><th>length</th><th>exons</th><th>structural_category</th><th>associated_gene</th><th>associated_transcript</th><th>ref_length</th><th>ref_exons</th><th>diff_to_TSS</th><th>diff_to_TTS</th><th>diff_to_gene_TSS</th><th>diff_to_gene_TTS</th><th>subcategory</th><th>RTS_stage</th><th>all_canonical</th><th>min_sample_cov</th><th>min_cov</th><th>min_cov_pos</th><th>sd_cov</th><th>FL</th><th>n_indels</th><th>n_indels_junc</th><th>bite</th><th>iso_exp</th><th>gene_exp</th><th>ratio_exp</th><th>FSM_class</th><th>coding</th><th>ORF_length</th><th>CDS_length</th><th>CDS_start</th><th>CDS_end</th><th>CDS_genomic_start</th><th>CDS_genomic_end</th><th>predicted_NMD</th><th>perc_A_downstream_TTS</th><th>seq_A_downstream_TTS</th><th>dist_to_CAGE_peak</th><th>within_CAGE_peak</th><th>dist_to_polyA_site</th><th>within_polyA_site</th><th>polyA_motif</th><th>polyA_dist</th><th>polyA_motif_found</th><th>ratio_TSS</th>
                </tr>
                <tr class="filters">
                    <th>isoform</th><th>chrom</th><th>strand</th><th>length</th><th>exons</th><th>structural_category</th><th>associated_gene</th><th>associated_transcript</th><th>ref_length</th><th>ref_exons</th><th>diff_to_TSS</th><th>diff_to_TTS</th><th>diff_to_gene_TSS</th><th>diff_to_gene_TTS</th><th>subcategory</th><th>RTS_stage</th><th>all_canonical</th><th>min_sample_cov</th><th>min_cov</th><th>min_cov_pos</th><th>sd_cov</th><th>FL</th><th>n_indels</th><th>n_indels_junc</th><th>bite</th><th>iso_exp</th><th>gene_exp</th><th>ratio_exp</th><th>FSM_class</th><th>coding</th><th>ORF_length</th><th>CDS_length</th><th>CDS_start</th><th>CDS_end</th><th>CDS_genomic_start</th><th>CDS_genomic_end</th><th>predicted_NMD</th><th>perc_A_downstream_TTS</th><th>seq_A_downstream_TTS</th><th>dist_to_CAGE_peak</th><th>within_CAGE_peak</th><th>dist_to_polyA_site</th><th>within_polyA_site</th><th>polyA_motif</th><th>polyA_dist</th><th>polyA_motif_found</th><th>ratio_TSS</th>
                </tr>
            </thead>
        </table>
    </div>

    <script>
        // The data is embedded directly into the HTML to make it self-contained (single file)
        var tableData = [{"isoform":"PB.23008.1","chrom":"chr22","strand":"+","length":2122,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_12","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":9,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":119.4086,"gene_exp":119.4086,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAATACAAAAAAAAAAAA","dist_to_CAGE_peak":-282.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.30437.1","chrom":"chr22","strand":"+","length":2003,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_19","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":4,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":175.598,"gene_exp":175.598,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":25.0,"seq_A_downstream_TTS":"AGTCGAGCGCTGCCAACATT","dist_to_CAGE_peak":-2272.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AATAAA","polyA_dist":-23.0,"polyA_motif_found":true,"ratio_TSS":1.9950248756},{"isoform":"PB.37858.1","chrom":"chr22","strand":"-","length":1879,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_28","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":63.8368,"gene_exp":63.8368,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":100.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAAAA","dist_to_CAGE_peak":-9996.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.37948.1","chrom":"chr22","strand":"-","length":1876,"exons":2,"structural_category":"intergenic","associated_gene":"novelGene_35","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"multi-exon","RTS_stage":true,"all_canonical":"non_canonical","min_sample_cov":0.0,"min_cov":0.0,"min_cov_pos":"junction_1","sd_cov":0.0,"FL":2,"n_indels":"","n_indels_junc":"","bite":true,"iso_exp":43.484,"gene_exp":43.484,"ratio_exp":1.0,"FSM_class":"A","coding":"coding","ORF_length":236.0,"CDS_length":708.0,"CDS_start":2.0,"CDS_end":709.0,"CDS_genomic_start":41302365.0,"CDS_genomic_end":41301658.0,"predicted_NMD":true,"perc_A_downstream_TTS":70.0,"seq_A_downstream_TTS":"AATAATAATAATAATAATAA","dist_to_CAGE_peak":-8.0,"within_CAGE_peak":true,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":1.0},{"isoform":"PB.45371.1","chrom":"chr22","strand":"+","length":1820,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_41","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":6,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":111.1944,"gene_exp":111.1944,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":65.0,"seq_A_downstream_TTS":"TCAAAAAAAAAGGAAAATGT","dist_to_CAGE_peak":23.0,"within_CAGE_peak":true,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AATAGA","polyA_dist":-14.0,"polyA_motif_found":true,"ratio_TSS":""},{"isoform":"PB.45507.1","chrom":"chr22","strand":"+","length":1764,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_50","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":142.298,"gene_exp":142.298,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":10.0,"seq_A_downstream_TTS":"TCTCCCTGTGTACATCCTTT","dist_to_CAGE_peak":-1208.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AATAAA","polyA_dist":-18.0,"polyA_motif_found":true,"ratio_TSS":2.9801980198},{"isoform":"PB.45518.1","chrom":"chr22","strand":"+","length":1823,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_51","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":21,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":110.18735,"gene_exp":110.18735,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":25.0,"seq_A_downstream_TTS":"ATATTGTGTAATATTTTCTG","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AAGAAA","polyA_dist":-44.0,"polyA_motif_found":true,"ratio_TSS":""},{"isoform":"PB.45532.1","chrom":"chr22","strand":"+","length":1852,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_52","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":8,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":58.55,"gene_exp":58.55,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":5.0,"seq_A_downstream_TTS":"TATCTCTTTGTCTTGTGTCT","dist_to_CAGE_peak":-1024.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.52878.1","chrom":"chr22","strand":"+","length":1688,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_53","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":9.26765,"gene_exp":9.26765,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":85.0,"seq_A_downstream_TTS":"TCAAAAAAAAAAAAAAAAGA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.52879.1","chrom":"chr22","strand":"+","length":1773,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_54","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":0.0,"gene_exp":0.0,"ratio_exp":"","FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAGTAAAAAAAAAAAAAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"TATAAA","polyA_dist":-27.0,"polyA_motif_found":true,"ratio_TSS":""},{"isoform":"PB.52890.1","chrom":"chr22","strand":"-","length":1717,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_56","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":83.3853,"gene_exp":83.3853,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAATAAAAAAAAAAAGAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.53042.1","chrom":"chr22","strand":"-","length":1714,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_62","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":6,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":39.67245,"gene_exp":39.67245,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":15.0,"seq_A_downstream_TTS":"ATATACTGGTTTCCTTCTCT","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AATAAA","polyA_dist":-22.0,"polyA_motif_found":true,"ratio_TSS":""},{"isoform":"PB.60743.1","chrom":"chr22","strand":"-","length":1500,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_66","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":104.1842,"gene_exp":104.1842,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":65.0,"seq_A_downstream_TTS":"AAAAACAATAAAATATACTC","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AATAAA","polyA_dist":-17.0,"polyA_motif_found":true,"ratio_TSS":0.7002997003},{"isoform":"PB.68207.1","chrom":"chr22","strand":"+","length":1365,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_68","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":23,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":27.5439,"gene_exp":27.5439,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":100.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAAAA","dist_to_CAGE_peak":-7.0,"within_CAGE_peak":true,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.75712.1","chrom":"chr22","strand":"+","length":1269,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_75","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":0.0,"gene_exp":0.0,"ratio_exp":"","FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":85.0,"seq_A_downstream_TTS":"AAAATTAAAAAAAAAAAAAG","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.83094.6","chrom":"chr22","strand":"+","length":1087,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_78","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":7,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":193.7175,"gene_exp":193.7175,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":95.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAGAAAAAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":1.0},{"isoform":"PB.83153.1","chrom":"chr22","strand":"-","length":1136,"exons":5,"structural_category":"intergenic","associated_gene":"novelGene_81","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"multi-exon","RTS_stage":false,"all_canonical":"canonical","min_sample_cov":0.0,"min_cov":0.0,"min_cov_pos":"junction_1","sd_cov":0.0,"FL":2,"n_indels":"","n_indels_junc":"","bite":true,"iso_exp":25.6674,"gene_exp":25.6674,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":25.0,"seq_A_downstream_TTS":"AATGCCACACTGTCTTCATT","dist_to_CAGE_peak":8.0,"within_CAGE_peak":true,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"ATTAAA","polyA_dist":-22.0,"polyA_motif_found":true,"ratio_TSS":""},{"isoform":"PB.88844.1","chrom":"chr22","strand":"-","length":3914,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_89","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":4,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":31.37205,"gene_exp":31.37205,"ratio_exp":1.0,"FSM_class":"A","coding":"coding","ORF_length":104.0,"CDS_length":312.0,"CDS_start":1011.0,"CDS_end":1322.0,"CDS_genomic_start":42298366.0,"CDS_genomic_end":42298055.0,"predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"TCAAAAAAAAAAAAAAAAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.96119.1","chrom":"chr22","strand":"-","length":871,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_93","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":0.0,"gene_exp":0.0,"ratio_exp":"","FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAATACAAAAAAAAAAAA","dist_to_CAGE_peak":-3116.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.96187.1","chrom":"chr22","strand":"-","length":849,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_95","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":12.14135,"gene_exp":12.14135,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":100.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.96203.1","chrom":"chr22","strand":"-","length":812,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_97","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":4,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":109.087,"gene_exp":109.087,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":95.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAGAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.96222.1","chrom":"chr22","strand":"+","length":883,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_98","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":22.6139,"gene_exp":22.6139,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":85.0,"seq_A_downstream_TTS":"AAAAATAAAAAAATAAAAGA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.103783.1","chrom":"chr22","strand":"+","length":564,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_107","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":184.6515,"gene_exp":184.6515,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAAAAAAAAGAAAAGAAA","dist_to_CAGE_peak":-8608.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.103803.1","chrom":"chr22","strand":"+","length":597,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_108","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":256.03,"gene_exp":256.03,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":100.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.111586.1","chrom":"chr22","strand":"-","length":281,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_117","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":31,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":125.6895,"gene_exp":125.6895,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAAAAATAAAAAAATAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.111595.1","chrom":"chr22","strand":"-","length":449,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_120","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":261.9695,"gene_exp":261.9695,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":95.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAGAAA","dist_to_CAGE_peak":-2702.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.111598.1","chrom":"chr22","strand":"+","length":410,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_121","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":4,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":321.01305,"gene_exp":321.01305,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAGAAAAGA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":1.0},{"isoform":"PB.118859.1","chrom":"chr22","strand":"-","length":320,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_124","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":80.0265,"gene_exp":80.0265,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAATAAAAG","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.118868.1","chrom":"chr22","strand":"-","length":314,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_126","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":5,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":0.0,"gene_exp":0.0,"ratio_exp":"","FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAAGT","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.119013.1","chrom":"chr22","strand":"+","length":276,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_137","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":324.9615,"gene_exp":324.9615,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":90.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAACAAAAAC","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.119024.1","chrom":"chr22","strand":"-","length":282,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_138","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":529.929,"gene_exp":529.929,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":100.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAAAA","dist_to_CAGE_peak":-938.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":1.0},{"isoform":"PB.124735.1","chrom":"chr22","strand":"-","length":3761,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_140","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":22.97631,"gene_exp":22.97631,"ratio_exp":1.0,"FSM_class":"A","coding":"coding","ORF_length":195.0,"CDS_length":585.0,"CDS_start":1312.0,"CDS_end":1896.0,"CDS_genomic_start":11948139.0,"CDS_genomic_end":11947555.0,"predicted_NMD":"","perc_A_downstream_TTS":65.0,"seq_A_downstream_TTS":"TCCATCTCAAAAAAAAAAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.124754.1","chrom":"chr22","strand":"-","length":3614,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_142","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":63.3983,"gene_exp":63.3983,"ratio_exp":1.0,"FSM_class":"A","coding":"coding","ORF_length":95.0,"CDS_length":285.0,"CDS_start":2287.0,"CDS_end":2571.0,"CDS_genomic_start":20153142.0,"CDS_genomic_end":20152858.0,"predicted_NMD":"","perc_A_downstream_TTS":85.0,"seq_A_downstream_TTS":"TCAAAAAAAAAAAAAAAAAC","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.124853.1","chrom":"chr22","strand":"+","length":3628,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_146","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":10,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":135.9675,"gene_exp":135.9675,"ratio_exp":1.0,"FSM_class":"A","coding":"coding","ORF_length":171.0,"CDS_length":513.0,"CDS_start":434.0,"CDS_end":946.0,"CDS_genomic_start":46078082.0,"CDS_genomic_end":46078594.0,"predicted_NMD":"","perc_A_downstream_TTS":80.0,"seq_A_downstream_TTS":"GGAAAAAAAAGAAAAAGAAA","dist_to_CAGE_peak":-4660.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":1.1663893511},{"isoform":"PB.130887.1","chrom":"chr22","strand":"-","length":3256,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_149","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":9.672785,"gene_exp":9.672785,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":85.0,"seq_A_downstream_TTS":"AAAAAGAAAAGAAAACAAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.130949.1","chrom":"chr22","strand":"+","length":3265,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_151","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":100.98065,"gene_exp":100.98065,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":95.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAAGAA","dist_to_CAGE_peak":-568.0,"within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":1.7984031936},{"isoform":"PB.130965.1","chrom":"chr22","strand":"+","length":3262,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_152","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":3,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":24.31725,"gene_exp":24.31725,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":85.0,"seq_A_downstream_TTS":"TCAAAAAAAAAAAAAAGAAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.137288.1","chrom":"chr22","strand":"+","length":3192,"exons":4,"structural_category":"intergenic","associated_gene":"novelGene_153","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"multi-exon","RTS_stage":false,"all_canonical":"canonical","min_sample_cov":0.0,"min_cov":0.0,"min_cov_pos":"junction_1","sd_cov":0.0,"FL":2,"n_indels":"","n_indels_junc":"","bite":false,"iso_exp":0.0,"gene_exp":0.0,"ratio_exp":"","FSM_class":"A","coding":"coding","ORF_length":189.0,"CDS_length":567.0,"CDS_start":1255.0,"CDS_end":1821.0,"CDS_genomic_start":12123232.0,"CDS_genomic_end":12123798.0,"predicted_NMD":false,"perc_A_downstream_TTS":25.0,"seq_A_downstream_TTS":"ATAATGAATTGTGCTTCTGT","dist_to_CAGE_peak":-10.0,"within_CAGE_peak":true,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AATAAA","polyA_dist":-18.0,"polyA_motif_found":true,"ratio_TSS":""},{"isoform":"PB.150525.1","chrom":"chr22","strand":"-","length":2682,"exons":5,"structural_category":"intergenic","associated_gene":"novelGene_164","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"multi-exon","RTS_stage":false,"all_canonical":"canonical","min_sample_cov":0.0,"min_cov":0.0,"min_cov_pos":"junction_1","sd_cov":0.0,"FL":2,"n_indels":"","n_indels_junc":"","bite":true,"iso_exp":29.07765,"gene_exp":29.07765,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":5.0,"seq_A_downstream_TTS":"TCTCTCTCTGTTTTCTTTTA","dist_to_CAGE_peak":7.0,"within_CAGE_peak":true,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"AATAAA","polyA_dist":-17.0,"polyA_motif_found":true,"ratio_TSS":""},{"isoform":"PB.150551.1","chrom":"chr22","strand":"-","length":2660,"exons":1,"structural_category":"intergenic","associated_gene":"novelGene_166","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"mono-exon","RTS_stage":false,"all_canonical":"","min_sample_cov":"","min_cov":"","min_cov_pos":"","sd_cov":"","FL":2,"n_indels":"","n_indels_junc":"","bite":"","iso_exp":25.4351,"gene_exp":25.4351,"ratio_exp":1.0,"FSM_class":"A","coding":"non_coding","ORF_length":"","CDS_length":"","CDS_start":"","CDS_end":"","CDS_genomic_start":"","CDS_genomic_end":"","predicted_NMD":"","perc_A_downstream_TTS":85.0,"seq_A_downstream_TTS":"TCAAAAAAAAAAAAAAAGAA","dist_to_CAGE_peak":"","within_CAGE_peak":false,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""},{"isoform":"PB.164563.1","chrom":"chr22","strand":"-","length":2463,"exons":2,"structural_category":"intergenic","associated_gene":"novelGene_185","associated_transcript":"novel","ref_length":"","ref_exons":"","diff_to_TSS":"","diff_to_TTS":"","diff_to_gene_TSS":"","diff_to_gene_TTS":"","subcategory":"multi-exon","RTS_stage":false,"all_canonical":"canonical","min_sample_cov":0.0,"min_cov":0.0,"min_cov_pos":"junction_1","sd_cov":0.0,"FL":2,"n_indels":"","n_indels_junc":"","bite":false,"iso_exp":42.4605,"gene_exp":42.4605,"ratio_exp":1.0,"FSM_class":"A","coding":"coding","ORF_length":193.0,"CDS_length":579.0,"CDS_start":1218.0,"CDS_end":1796.0,"CDS_genomic_start":30278682.0,"CDS_genomic_end":30278104.0,"predicted_NMD":false,"perc_A_downstream_TTS":95.0,"seq_A_downstream_TTS":"AAAAAAAAAAAAAAAAGAAA","dist_to_CAGE_peak":3.0,"within_CAGE_peak":true,"dist_to_polyA_site":"","within_polyA_site":"","polyA_motif":"","polyA_dist":"","polyA_motif_found":false,"ratio_TSS":""}];
        var tableColumns = [{"data": "isoform", "title": "isoform"}, {"data": "chrom", "title": "chrom"}, {"data": "strand", "title": "strand"}, {"data": "length", "title": "length"}, {"data": "exons", "title": "exons"}, {"data": "structural_category", "title": "structural_category"}, {"data": "associated_gene", "title": "associated_gene"}, {"data": "associated_transcript", "title": "associated_transcript"}, {"data": "ref_length", "title": "ref_length"}, {"data": "ref_exons", "title": "ref_exons"}, {"data": "diff_to_TSS", "title": "diff_to_TSS"}, {"data": "diff_to_TTS", "title": "diff_to_TTS"}, {"data": "diff_to_gene_TSS", "title": "diff_to_gene_TSS"}, {"data": "diff_to_gene_TTS", "title": "diff_to_gene_TTS"}, {"data": "subcategory", "title": "subcategory"}, {"data": "RTS_stage", "title": "RTS_stage"}, {"data": "all_canonical", "title": "all_canonical"}, {"data": "min_sample_cov", "title": "min_sample_cov"}, {"data": "min_cov", "title": "min_cov"}, {"data": "min_cov_pos", "title": "min_cov_pos"}, {"data": "sd_cov", "title": "sd_cov"}, {"data": "FL", "title": "FL"}, {"data": "n_indels", "title": "n_indels"}, {"data": "n_indels_junc", "title": "n_indels_junc"}, {"data": "bite", "title": "bite"}, {"data": "iso_exp", "title": "iso_exp"}, {"data": "gene_exp", "title": "gene_exp"}, {"data": "ratio_exp", "title": "ratio_exp"}, {"data": "FSM_class", "title": "FSM_class"}, {"data": "coding", "title": "coding"}, {"data": "ORF_length", "title": "ORF_length"}, {"data": "CDS_length", "title": "CDS_length"}, {"data": "CDS_start", "title": "CDS_start"}, {"data": "CDS_end", "title": "CDS_end"}, {"data": "CDS_genomic_start", "title": "CDS_genomic_start"}, {"data": "CDS_genomic_end", "title": "CDS_genomic_end"}, {"data": "predicted_NMD", "title": "predicted_NMD"}, {"data": "perc_A_downstream_TTS", "title": "perc_A_downstream_TTS"}, {"data": "seq_A_downstream_TTS", "title": "seq_A_downstream_TTS"}, {"data": "dist_to_CAGE_peak", "title": "dist_to_CAGE_peak"}, {"data": "within_CAGE_peak", "title": "within_CAGE_peak"}, {"data": "dist_to_polyA_site", "title": "dist_to_polyA_site"}, {"data": "within_polyA_site", "title": "within_polyA_site"}, {"data": "polyA_motif", "title": "polyA_motif"}, {"data": "polyA_dist", "title": "polyA_dist"}, {"data": "polyA_motif_found", "title": "polyA_motif_found"}, {"data": "ratio_TSS", "title": "ratio_TSS"}];
        var numericColumns = ["length", "exons", "ref_length", "ref_exons", "diff_to_TSS", "diff_to_TTS", "diff_to_gene_TSS", "diff_to_gene_TTS", "min_sample_cov", "min_cov", "sd_cov", "FL", "n_indels", "n_indels_junc", "iso_exp", "gene_exp", "ratio_exp", "ORF_length", "CDS_length", "CDS_start", "CDS_end", "CDS_genomic_start", "CDS_genomic_end", "perc_A_downstream_TTS", "dist_to_CAGE_peak", "dist_to_polyA_site", "within_polyA_site", "polyA_dist", "ratio_TSS"];
        var categoricalColumns = ["strand", "structural_category", "subcategory", "RTS_stage", "all_canonical", "min_cov_pos", "bite", "FSM_class", "coding", "predicted_NMD", "within_CAGE_peak", "polyA_motif_found"];

        // Custom filtering function for range search and special exact match cases
        $.fn.dataTable.ext.search.push(
            function( settings, data, dataIndex ) {
                var result = true;
                
                // Iterate over all columns to check for active range filters
                // We use settings.aoColumns to get column info
                for (var i = 0; i < settings.aoColumns.length; i++) {
                    var colName = settings.aoColumns[i].data;
                    
                    // Find the input value for this column
                    // We target the input in the visible scroll header first
                    var input = $('.dataTables_scrollHead .filters [data-index="'+i+'"]');
                    if (input.length === 0) {
                        // Fallback to any input with this index (e.g. if not scrolling)
                        input = $('.filters [data-index="'+i+'"]');
                    }
                    
                    var filterVal = input.val();
                    if (!filterVal) continue;
                    
                    // Special case: Exact match for categorical columns (dropdowns)
                    if (categoricalColumns.includes(colName)) {
                        // Exact string match (case sensitive)
                        // We convert data to string just in case (e.g. numbers treated as categories)
                        if (String(data[i]) !== filterVal) {
                            result = false;
                            break;
                        }
                        continue; 
                    }
                    
                    // Only check numeric columns for range logic
                    if (!numericColumns.includes(colName)) continue;
                    
                    // Only apply custom range logic if filter contains ':'
                    if (filterVal.indexOf(':') !== -1) {
                        var parts = filterVal.split(':');
                        var minStr = parts[0].trim();
                        var maxStr = parts[1].trim();
                        
                        var min = minStr !== "" ? parseFloat(minStr) : -Infinity;
                        var max = maxStr !== "" ? parseFloat(maxStr) : Infinity;
                        
                        var cellVal = parseFloat(data[i]);
                        
                        if (isNaN(cellVal)) {
                            result = false;
                            break;
                        }
                        
                        if (cellVal < min || cellVal > max) {
                            result = false;
                            break;
                        }
                    } else {
                        // Exact numeric match (not substring match)
                        var searchNum = parseFloat(filterVal);
                        var cellVal = parseFloat(data[i]);
                        
                        // If the filter value is a valid number
                        if (!isNaN(searchNum)) {
                            // If cell is not a number (e.g. empty), it doesn't match
                            if (isNaN(cellVal)) {
                                result = false;
                                break;
                            }
                            
                            // Exact match check
                            if (cellVal !== searchNum) {
                                result = false;
                                break;
                            }
                        }
                        // If filter is not a number (e.g. text search in numeric col)
                        else if (filterVal === data[i]) {
                             // Exact string match allowed (e.g. for 'NA')
                        }
                        else {
                            // Filter is text but doesn't match exact string
                             result = false; 
                             break;
                        }
                    }
                }
                
                return result;
            }
        );

        $(document).ready(function() {
            // Setup - add inputs or dropdowns
            $('#isoformTable thead tr.filters th').each( function (i) {
                var title = $(this).text();
                
                if (categoricalColumns.includes(title)) {
                    // Create dropdown
                    var select = $('<select data-index="'+i+'"><option value="">All</option></select>');
                    
                    // Get unique values from tableData for this column
                    // We use Set to get unique values
                    var unique = [...new Set(tableData.map(item => item[title]))].sort();
                    
                    unique.forEach(function(d) {
                        // Skip empty values for options
                        if (d !== "" && d !== null && d !== undefined) {
                            select.append('<option value="'+d+'">'+d+'</option>');
                        }
                    });
                    
                    $(this).html(select);
                } else {
                    // Create text input
                    $(this).html( '<input type="text" placeholder="Search '+title+'" data-index="'+i+'" />' );
                }
            } );
         
            // Initialize DataTable
            var table = $('#isoformTable').DataTable({
                data: tableData,
                columns: tableColumns,
                dom: 'Bfrtip',
                pageLength: 25,
                lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                scrollX: true,     // Enable horizontal scrolling
                scrollY: '70vh',   // Enable vertical scrolling with fixed header
                scrollCollapse: true,
                autoWidth: true,
                orderCellsTop: true, // Important: tells DataTables the first row is for ordering
                buttons: [
                    'pageLength',
                    {
                        text: 'Generate Trix String',
                        action: function ( e, dt, node, config ) {
                            var queryParts = [];
                            var api = dt;
                            var settings = api.settings()[0];
                            
                            api.columns().every(function(i) {
                                var colName = settings.aoColumns[i].data;
                                // Target the correct input (handling scrolling duplicates)
                                var input = $('.dataTables_scrollHead .filters [data-index="'+i+'"]');
                                if (input.length === 0) {
                                    input = $('.filters [data-index="'+i+'"]');
                                }
                                
                                var val = input.val();
                                if (val) {
                                    queryParts.push(colName + ":" + val);
                                }
                            });
                            
                            var searchString = queryParts.join(" ");
                            if (!searchString) {
                                alert("No filters active.");
                            } else {
                                prompt("Copy this search string for UCSC Genome Browser:", searchString);
                            }
                        }
                    },
                    {
                        extend: 'excelHtml5',
                        title: 'SQANTI3_intergenic_Isoforms'
                    },
                    {
                        extend: 'csvHtml5',
                        title: 'SQANTI3_intergenic_Isoforms'
                    },
                    'copy'
                ],
                initComplete: function () {
                    // No manual event binding here anymore, we use delegated events below
                }
            });
            
            // Delegated event listener for inputs AND selects
            $(table.table().container()).on('keyup change clear', 'thead input, thead select', function () {
                var input = $(this);
                var colIdx = input.data('index');
                var val = this.value;
                
                // Sync value to all inputs/selects for this column
                var tagName = input.prop("tagName");
                $(tagName + '[data-index="'+colIdx+'"]').val(val);
                
                var column = table.column(colIdx);
                var colName = column.dataSrc();
                
                // If numeric column OR categorical column, ALWAYS use custom search (clear standard search)
                if (numericColumns.includes(colName) || categoricalColumns.includes(colName)) {
                    if (column.search() !== "") {
                        column.search(""); 
                    }
                    table.draw(); // Trigger custom filter
                } else {
                    // Standard search behavior for other columns
                    if (column.search() !== val) {
                        column.search(val).draw();
                    }
                }
            });
        });
    </script>
</body>
</html>
